---
title: "Data Visualizations for HRDP RNA Data from the Brain and Liver"
author: "Angela Yoder"
date: "`r Sys.Date()`"
---

**The goals of this program are:**

1. Range of genes in histogram
2. Strain means via RLE
3. Broad Sense Heritability
4. Hierarchical Clustering Plot
5. PCA plot


```{r}
# Data Import

# set working directory
setwd("C:/Users/angel/OneDrive/Desktop/Saba Lab/Data/")

# download brain and liver datasets
brain = read.csv("PhenoGen.HRDP.v5.totalRNA.Brain.gene.ensembl96.txt", header = T, sep = "\t")
liver = read.csv("PhenoGen.HRDP.v5.totalRNA.Liver.gene.ensembl96.txt", header = T, sep = "\t")

# download strain means dataset
storagematrix_brain = read.csv("Means_strainXgene_brain.csv")
storagematrix_liver = read.csv("Means_strainXgene_liver.csv")

# download BSH vectors
fin.r.squared_brain = read.csv("R_Squared_Brain.csv")
fin.r.squared_liver = read.csv("R_Squared_Liver.csv")

# download RLE matrices
RLE_brain = read.csv("RLE_Brain.csv")
RLE_liver = read.csv("RLE_Liver.csv")
```

```{r}

# Range of Genes

# distribution of gene ranges
range_brain = numeric(dim(brain)[1])
for (i in 1:dim(brain)[1])
{
  r = range(brain[i,])
  m = r[2] - r[1]
  range_brain[i] = 2^m
}

range_liver = numeric(dim(liver)[1])
for (i in 1:dim(liver)[1])
{
  r = range(liver[i,])
  m = r[2] - r[1]
  range_liver[i] = 2^m
}

hist(range_brain, main = "Range by Gene: Brain", xlab = "Range", breaks = 24)
hist(range_liver, main = "Range by Gene: Liver", xlab = "Range", breaks = 24)

```

```{r}

# RLE


boxplot(x = t(RLE_brain[,2:dim(RLE_brain)[2]]), main = "RLE plot: Brain dataset", xlab = "Strain")
boxplot(x = t(RLE_liver[,2:dim(RLE_liver)[2]]), main = "RLE plot: Liver dataset", xlab = "Strain")

```

```{r}

#Broad Sense Heritability

hist(as.numeric(fin.r.squared_brain[,3]), main = "Broad Sense Heritability: Brain", xlab = "R-Squared Value")
hist(as.numeric(fin.r.squared_liver[,3]), main = "Broad Sense Heritability: Liver", xlab = "R-Squared Value")
```

```{r}

#Hierarchical Clustering

for_clustering_brain = as.dist(1 - abs(cor(x = brain, method = "spearman")))
for_clustering_liver = as.dist(1 - abs(cor(x = liver, method = "spearman")))

h_clustering_brain = hclust(for_clustering_brain)
h_clustering_liver = hclust(for_clustering_liver)

plot(h_clustering_brain, main = "Hierarchical Clustering: Brain", xlab = "")
plot(h_clustering_liver, main = "Hierarchical Clustering: Liver", xlab = "")

```

Different clustering strategies?

```{r}

# PCA Plot

# PCA
library(PCAtools)

pca_brain <- pca(brain, center=TRUE, scale=TRUE)
pca_liver = pca(liver, center = TRUE, scale = TRUE)

biplot(pca_brain)
biplot(pca_liver)
