# Data Summary of HRDP RNA Data from the Brain and Liver Continued 
## Angela Yoder

Goals: Use Phenogen HRDP total RNA ensemble data for Brain and Liver to calculate Broad Sense Heritability and Hierarchical Clustering

```{r}

# set working directory
setwd("C:/Users/angel/OneDrive/Desktop/Saba Lab/Data")

library(tidyverse)

# download brain and liver datasets
brain = read.csv("PhenoGen.HRDP.v5.totalRNA.Brain.gene.ensembl96.txt", header = T, sep = "\t")
liver = read.csv("PhenoGen.HRDP.v5.totalRNA.Liver.gene.ensembl96.txt", header = T, sep = "\t")
```

```{r}

library(tidyverse)
## Means of strains


# extracting strain from colname
rats_brain = sub("_.*", "", colnames(brain))
rats_liver = sub("_.*", "", colnames(liver))

strains_brain = unique(rats_brain)
strains_liver = unique(rats_liver)

# adding new row for strain
#which i did at some point but now its deleted yay me
new_brain = t(brain)
new_liver = t(liver)

means_brain = apply(X = new_brain, FUN = mean, MARGIN = 1)
means_liver = apply(X = new_liver, FUN = mean, MARGIN = 1)

new_brain = cbind(rats_brain, means_brain, new_brain)
new_liver = cbind(rats_liver, means_liver, new_liver)


new_liver %>%
  group_by(rats_liver) %>%
  summarize(mean(means_liver))

new_brain %>%
  group_by(rats_brain)

storagematrix = matrix(NA, nrow = length(strains_brain), ncol = dim(new_brain)[2])
for (i in 1:length(strains_brain))
{
  b = new_brain[new_brain[,"rats_brain"] == strains_brain[i],]
  for (j in 3:dim(new_brain)[2])
  {
    v = mean(as.numeric(b[,j]))
    r = j-2
    storagematrix[i, r] = v
  }
}


for (i in new_brain[2:10,])
{
  summarize(mean(i))
}



```